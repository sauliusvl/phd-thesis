(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     68546,       2057]
NotebookOptionsPosition[     64298,       1914]
NotebookOutlinePosition[     64661,       1930]
CellTagsIndexPosition[     64618,       1927]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"SL", "(", "2", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " spin chain"
}], "Title",
 CellChangeTimes->{{3.5879097950982113`*^9, 3.587909805444989*^9}}],

Cell["Hamiltonian", "Subtitle",
 CellChangeTimes->{{3.5879098115625415`*^9, 3.5879098130607176`*^9}}],

Cell["\<\
The density and full Hamiltonian\
\>", "Text",
 CellChangeTimes->{{3.5879098338479095`*^9, 3.5879098407925797`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[GothicCapitalH]", "[", 
   RowBox[{
    RowBox[{"st", ":", 
     RowBox[{"s", "[", "a__", "]"}]}], ",", "ii_", ",", "jj_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"L", ",", "i", ",", "j", ",", "k", ",", "m"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"L", "=", 
      RowBox[{"Length", "[", "st", "]"}]}], ";", 
     RowBox[{"i", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{"ii", ",", "L", ",", "1"}], "]"}]}], ";", 
     RowBox[{"j", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{"jj", ",", "L", ",", "1"}], "]"}]}], ";", 
     RowBox[{"k", "=", 
      RowBox[{"st", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", 
     RowBox[{"m", "=", 
      RowBox[{"st", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"kp", "=", "0"}], 
       RowBox[{"m", "+", "k"}]], 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k", "==", "kp"}], ",", 
         RowBox[{
          RowBox[{"HarmonicNumber", "[", "k", "]"}], "+", 
          RowBox[{"HarmonicNumber", "[", "m", "]"}]}], ",", 
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{"Abs", "[", 
            RowBox[{"k", "-", "kp"}], "]"}]]}]}], "]"}], 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"st", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "\[Rule]", "kp"}], ",", 
           RowBox[{"j", "\[Rule]", 
            RowBox[{"m", "+", "k", "-", "kp"}]}]}], "}"}]}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", 
   RowBox[{"st", ":", 
    RowBox[{"s", "[", "a__", "]"}]}], "]"}], ":=", 
  RowBox[{
   SubsuperscriptBox["\[Sum]", 
    RowBox[{"i", "=", "1"}], 
    RowBox[{"Length", "[", "st", "]"}]], 
   RowBox[{"\[GothicCapitalH]", "[", 
    RowBox[{"st", ",", "i", ",", 
     RowBox[{"i", "+", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{"expr", "/.", 
    RowBox[{
     RowBox[{"st", ":", 
      RowBox[{"s", "[", "a__", "]"}]}], "\[RuleDelayed]", 
     RowBox[{"H", "[", 
      RowBox[{"s", "[", "a", "]"}], "]"}]}]}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"s", "[", "__", "]"}], ",", "Simplify"}], "]"}], 
    "&"}]}]}]}], "Input",
 CellChangeTimes->{{3.587468044956807*^9, 3.5874680556744595`*^9}, {
   3.587469961432415*^9, 3.5874700894974246`*^9}, {3.5874701303213687`*^9, 
   3.5874701321649303`*^9}, {3.5877155688252497`*^9, 3.5877155902002497`*^9}, 
   3.5877157478721247`*^9, 3.5877207313822985`*^9, {3.5877238010850124`*^9, 
   3.587724062683421*^9}, {3.5877241060344715`*^9, 3.587724155290984*^9}, {
   3.58772421873355*^9, 3.5877242385739985`*^9}}],

Cell["\<\

Test it out:\
\>", "Text",
 CellChangeTimes->{{3.587909844959381*^9, 3.5879098485331554`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "[", 
  RowBox[{"s", "[", 
   RowBox[{"1", ",", "2", ",", "3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.587470154006443*^9, 3.5874701779258685`*^9}, {
  3.587470218171747*^9, 3.587470218749813*^9}, {3.5874702767594967`*^9, 
  3.587470277931252*^9}, {3.5874703378938613`*^9, 3.5874703603134403`*^9}, {
  3.5877147190752497`*^9, 3.5877147191689997`*^9}, {3.5877242583832016`*^9, 
  3.587724265835086*^9}, {3.587724310155835*^9, 3.587724311999278*^9}, {
  3.587724380769083*^9, 3.5877243809096847`*^9}, {3.5879060577389555`*^9, 
  3.5879060578952055`*^9}, {3.5879098509364796`*^9, 3.5879098514826894`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"s", "(", 
     RowBox[{"0", ",", "2", ",", "4"}], ")"}]}], "-", 
   RowBox[{"s", "(", 
    RowBox[{"0", ",", "3", ",", "3"}], ")"}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"s", "(", 
     RowBox[{"1", ",", "0", ",", "5"}], ")"}]}], "-", 
   RowBox[{"s", "(", 
    RowBox[{"1", ",", "1", ",", "4"}], ")"}], "+", 
   RowBox[{
    FractionBox["26", "3"], " ", 
    RowBox[{"s", "(", 
     RowBox[{"1", ",", "2", ",", "3"}], ")"}]}], "-", 
   RowBox[{"s", "(", 
    RowBox[{"1", ",", "3", ",", "2"}], ")"}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"s", "(", 
     RowBox[{"1", ",", "4", ",", "1"}], ")"}]}], "-", 
   RowBox[{
    FractionBox["1", "3"], " ", 
    RowBox[{"s", "(", 
     RowBox[{"1", ",", "5", ",", "0"}], ")"}]}], "-", 
   RowBox[{"s", "(", 
    RowBox[{"2", ",", "1", ",", "3"}], ")"}], "-", 
   RowBox[{"s", "(", 
    RowBox[{"2", ",", "2", ",", "2"}], ")"}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"s", "(", 
     RowBox[{"3", ",", "0", ",", "3"}], ")"}]}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"s", "(", 
     RowBox[{"3", ",", "2", ",", "1"}], ")"}]}], "-", 
   RowBox[{
    FractionBox["1", "3"], " ", 
    RowBox[{"s", "(", 
     RowBox[{"4", ",", "2", ",", "0"}], ")"}]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.5874701560062385`*^9, 3.58747017820709*^9}, {
   3.5874702092820325`*^9, 3.5874702346388106`*^9}, 3.587470278431201*^9, {
   3.5874703404873457`*^9, 3.5874703605790377`*^9}, 3.5877147197783747`*^9, 
   3.587720753085284*^9, {3.5877242556649036`*^9, 3.5877242662881355`*^9}, 
   3.587724312233614*^9, 3.5877243812221327`*^9, 3.5878082712233753`*^9, 
   3.587897088615323*^9, 3.5879059065514555`*^9, 3.5879061276139555`*^9, 
   3.5879098519664755`*^9, 3.5879106123881598`*^9, 3.5890253852779503`*^9, 
   3.589112100399559*^9, 3.605526939837044*^9}]
}, Open  ]],

Cell["\<\

Basis:\
\>", "Text",
 CellChangeTimes->{{3.5879098604405336`*^9, 3.5879098621259813`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Basis", "[", 
   RowBox[{"l_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Permutations", "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"PadLeft", "[", 
          RowBox[{"#", ",", "l"}], "]"}], "&"}], "/@", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "l"}], "}"}]}], "]"}]}], ")"}]}], ",", "1"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5877147411689997`*^9, 3.5877147886377497`*^9}, {
  3.5877148754814997`*^9, 3.5877150272471247`*^9}, {3.5879099412171893`*^9, 
  3.5879099436829376`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Basis", "[", 
  RowBox[{"2", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.5877149976064997`*^9, 3.5877149991689997`*^9}, {
  3.5877150639814997`*^9, 3.5877150793252497`*^9}, {3.587724293549224*^9, 
  3.587724343353435*^9}, {3.5877252891550627`*^9, 3.5877252892800517`*^9}, {
  3.5879062197858305`*^9, 3.5879062198483305`*^9}, {3.5879099499721556`*^9, 
  3.5879099509397273`*^9}, {3.58902540266813*^9, 3.589025402793127*^9}, {
  3.6055269549125633`*^9, 3.605526955990502*^9}, {3.6055279813098946`*^9, 
  3.6055279814348936`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"s", "(", 
     RowBox[{"0", ",", "2"}], ")"}], ",", 
    RowBox[{"s", "(", 
     RowBox[{"2", ",", "0"}], ")"}], ",", 
    RowBox[{"s", "(", 
     RowBox[{"1", ",", "1"}], ")"}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.5877149996533747`*^9, 3.5877150283721247`*^9}, {
   3.5877150644346247`*^9, 3.5877150795127497`*^9}, 3.5877207558821416`*^9, {
   3.587724297267355*^9, 3.5877243435721483`*^9}, 3.587725299888476*^9, 
   3.5878082712702503`*^9, 3.5878970886622005`*^9, 3.5879059066139555`*^9, 
   3.5879062201139555`*^9, {3.5879099462579274`*^9, 3.5879099512362413`*^9}, 
   3.587910612497402*^9, {3.589025385340449*^9, 3.5890254033712373`*^9}, 
   3.5891121004307995`*^9, {3.605526941774209*^9, 3.6055269562560806`*^9}, 
   3.605527981638017*^9}]
}, Open  ]],

Cell["\<\

Matrix elements:\
\>", "Text",
 CellChangeTimes->{{3.587909869663679*^9, 3.5879098726444254`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HH", "[", 
   RowBox[{"l_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"basis", "=", 
      RowBox[{"Basis", "[", 
       RowBox[{"l", ",", "n"}], "]"}]}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"H", "[", 
         RowBox[{"basis", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "basis"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", "basis"}]}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5877151741689997`*^9, 3.5877152083408747`*^9}, {
  3.5877153670439997`*^9, 3.5877153762002497`*^9}, {3.5877216758762536`*^9, 
  3.587721678048115*^9}, {3.5879099540453215`*^9, 3.587909959975601*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HH", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "//", "Eigensystem"}], "//", 
  "Transpose"}]], "Input",
 CellChangeTimes->{{3.5877153781064997`*^9, 3.5877153795596247`*^9}, {
   3.5877154664814997`*^9, 3.5877155230596247`*^9}, {3.5877207805069838`*^9, 
   3.5877207924444075`*^9}, {3.58772098894315*^9, 3.5877209892556477`*^9}, {
   3.5877214219560037`*^9, 3.587721422065378*^9}, {3.587721460502632*^9, 
   3.5877214606745057`*^9}, {3.58772168186059*^9, 3.587721682282462*^9}, {
   3.587721807547286*^9, 3.5877218085472794`*^9}, {3.587723597597246*^9, 
   3.587723597706525*^9}, {3.5877243326052237`*^9, 3.587724368474254*^9}, {
   3.5877253348384695`*^9, 3.587725334916587*^9}, {3.587725949752118*^9, 
   3.587725950611416*^9}, {3.5877287450776367`*^9, 3.5877287552484694`*^9}, {
   3.5877287881982203`*^9, 3.5877287886356754`*^9}, {3.587731214291196*^9, 
   3.587731214400364*^9}, {3.5878083543171253`*^9, 3.5878083546921253`*^9}, {
   3.587822791513935*^9, 3.587822803401364*^9}, {3.5878970973657713`*^9, 
   3.5878971013034725`*^9}, 3.5879062576920805`*^9, {3.5879063394420805`*^9, 
   3.5879063406608305`*^9}, {3.5879073905986915`*^9, 3.5879073907045946`*^9}, 
   3.587909881399391*^9, {3.5879099661399717`*^9, 3.5879099669514837`*^9}, {
   3.587911286615445*^9, 3.587911286754534*^9}, {3.587911835006457*^9, 
   3.5879118350997634`*^9}, {3.5879119082676888`*^9, 3.587911912046606*^9}, {
   3.587911957393614*^9, 3.587911995842935*^9}, {3.5879122460763264`*^9, 
   3.587912280867302*^9}, {3.589025406886772*^9, 3.5890254070742674`*^9}, {
   3.589026588106532*^9, 3.589026588215904*^9}, {3.6055269599429436`*^9, 
   3.6055269616145296`*^9}, {3.6055278634825234`*^9, 3.605527863654397*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"6", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", "2"}], "}"}]},
     {"4", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]},
     {"0", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.5877153800127497`*^9, {3.5877154715908747`*^9, 3.5877155236221247`*^9}, {
   3.587720758757123*^9, 3.587720793647525*^9}, 3.5877209896775203`*^9, 
   3.5877214225028753`*^9, 3.587721461002629*^9, 3.5877216827824593`*^9, 
   3.5877218090629015`*^9, 3.587723598502696*^9, {3.5877243409632077`*^9, 
   3.587724372411099*^9}, 3.587725335635273*^9, 3.5877258167015405`*^9, {
   3.587728749233461*^9, 3.587728758826228*^9}, 3.587728806727573*^9, 
   3.587731217893756*^9, 3.5878082746296253`*^9, 3.5878083555515003`*^9, {
   3.587822794263196*^9, 3.5878228036512966`*^9}, {3.58789708884971*^9, 
   3.587897101569111*^9}, 3.5879059068483305`*^9, 3.5879062581452055`*^9, 
   3.5879063533170805`*^9, 3.5879066999420805`*^9, 3.5879073910568357`*^9, 
   3.587909882210903*^9, {3.5879099635025578`*^9, 3.5879099673728456`*^9}, 
   3.587910612575433*^9, 3.587911286970894*^9, 3.5879118354885406`*^9, {
   3.587911908718671*^9, 3.5879119123731794`*^9}, {3.587911957875698*^9, 
   3.587911996154403*^9}, {3.587912247259905*^9, 3.5879122810697565`*^9}, {
   3.589025385840436*^9, 3.5890254074648824`*^9}, 3.5890265885283966`*^9, 
   3.5891121006026216`*^9, {3.6055269439925756`*^9, 3.6055269621769323`*^9}, 
   3.605527864185644*^9, 3.605527985419243*^9}]
}, Open  ]],

Cell["\<\

Test it out:\
\>", "Text",
 CellChangeTimes->{{3.587909920508027*^9, 3.5879099225836253`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"L", "=", "2"}], ",", 
     RowBox[{"n", "=", "2"}], ",", "sln", ",", "basis", ",", "ev", ",", 
     RowBox[{"sn", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sln", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"HH", "[", 
        RowBox[{"L", ",", "n"}], "]"}], "//", "Eigensystem"}], "//", 
      "Transpose"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"basis", "=", 
     RowBox[{"Basis", "[", 
      RowBox[{"L", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ev", "=", 
     RowBox[{
      RowBox[{"sln", "[", 
       RowBox[{"[", 
        RowBox[{"sn", ",", "2"}], "]"}], "]"}], ".", "basis"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{"H", "[", "ev", "]"}], ",", "basis"}], "]"}], 
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{"ev", ",", "basis"}], "]"}], "+", "\[Epsilon]"}]], "//", 
          "Quiet"}], ",", 
         RowBox[{"sln", "[", 
          RowBox[{"[", 
           RowBox[{"sn", ",", "1"}], "]"}], "]"}]}], "}"}], "/.", 
       RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "//", "Simplify"}], "//", 
     "Column"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.5879099236292276`*^9, 3.587909929824809*^9}, {
  3.5879099728973694`*^9, 3.587910103644906*^9}, {3.5879101389771166`*^9, 
  3.5879101404753017`*^9}, {3.587911183480728*^9, 3.587911197620201*^9}, {
  3.587911279135564*^9, 3.587911279305561*^9}, {3.589025411761647*^9, 
  3.5890254118710194`*^9}, {3.5890265925126696`*^9, 3.5890265926532907`*^9}, {
  3.6055276557671747`*^9, 3.6055277735305386`*^9}, {3.6055278166234612`*^9, 
  3.605527879451171*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{"{", 
       RowBox[{"6", ",", "6", ",", "6"}], "}"}]},
     {"6"}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.5879100834037943`*^9, 3.5879101042067256`*^9}, 
   3.587910140927879*^9, 3.5879106126222515`*^9, {3.587911184363494*^9, 
   3.587911198000703*^9}, 3.587911279506467*^9, {3.589025385965433*^9, 
   3.58902541224601*^9}, 3.589026592872035*^9, 3.589112100727583*^9, 
   3.6055269455235605`*^9, {3.6055276579233837`*^9, 3.605527774155527*^9}, {
   3.6055278173890715`*^9, 3.60552787966992*^9}, 3.605527986872359*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"state", "=", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "=", "2"}], ",", 
       RowBox[{"n", "=", "2"}], ",", "sln"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sln", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"HH", "[", 
          RowBox[{"L", ",", "n"}], "]"}], "//", "Eigensystem"}], "//", 
        "Transpose"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Basis", "[", 
            RowBox[{"L", ",", "n"}], "]"}], ".", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
       "sln"}]}]}], "\[IndentingNewLine]", "]"}], "//", "Column"}]}]], "Input",
 CellChangeTimes->{{3.5879101650393033`*^9, 3.587910211326996*^9}, {
  3.589025416777144*^9, 3.5890254182458563`*^9}, {3.5890265960594535`*^9, 
  3.5890265962156997`*^9}, {3.605527003810362*^9, 3.6055272968933306`*^9}, {
  3.605527998684783*^9, 3.605527998825407*^9}}],

Cell[BoxData[
 FormBox[
  TagBox[GridBox[{
     {
      RowBox[{"{", 
       RowBox[{"6", ",", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"s", "(", 
           RowBox[{"0", ",", "2"}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"s", "(", 
           RowBox[{"1", ",", "1"}], ")"}]}], "-", 
         RowBox[{"s", "(", 
          RowBox[{"2", ",", "0"}], ")"}]}]}], "}"}]},
     {
      RowBox[{"{", 
       RowBox[{"4", ",", 
        RowBox[{
         RowBox[{"s", "(", 
          RowBox[{"2", ",", "0"}], ")"}], "-", 
         RowBox[{"s", "(", 
          RowBox[{"0", ",", "2"}], ")"}]}]}], "}"}]},
     {
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"s", "(", 
          RowBox[{"0", ",", "2"}], ")"}], "+", 
         RowBox[{"s", "(", 
          RowBox[{"1", ",", "1"}], ")"}], "+", 
         RowBox[{"s", "(", 
          RowBox[{"2", ",", "0"}], ")"}]}]}], "}"}]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.587910208252594*^9, 3.587910212138513*^9}, 
   3.587910612715888*^9, 3.5890253860123067`*^9, 3.589025418527099*^9, 
   3.5890265964188194`*^9, 3.5891121007744436`*^9, {3.6055270006702795`*^9, 
   3.6055270891393647`*^9}, {3.605527121290058*^9, 3.6055272983932347`*^9}, 
   3.605527999059781*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5879105541930127`*^9, 3.5879105547080145`*^9}}],

Cell[CellGroupData[{

Cell["Bethe Ansatz", "Subtitle",
 CellChangeTimes->{{3.5879102325668983`*^9, 3.5879102354072084`*^9}, 
   3.587910541583284*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Bae", "[", 
   RowBox[{"L_", ",", "M_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"u", "[", "k", "]"}], "+", 
         RowBox[{"I", "/", "2"}]}], 
        RowBox[{
         RowBox[{"u", "[", "k", "]"}], "-", 
         RowBox[{"I", "/", "2"}]}]], ")"}], "L"], "\[Equal]", 
     RowBox[{"-", 
      RowBox[{
       SubsuperscriptBox["\[Product]", 
        RowBox[{"j", "=", "1"}], "M"], 
       FractionBox[
        RowBox[{
         RowBox[{"u", "[", "k", "]"}], "-", 
         RowBox[{"u", "[", "j", "]"}], "-", "I"}], 
        RowBox[{
         RowBox[{"u", "[", "k", "]"}], "-", 
         RowBox[{"u", "[", "j", "]"}], "+", "I"}]]}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "M"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.587715969294323*^9, 3.587716087013827*^9}, {
  3.587719961146103*^9, 3.5877199756463814`*^9}, {3.5877213791906524`*^9, 
  3.5877213883624687`*^9}, {3.5877228495874915`*^9, 3.587722850103113*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AllDifferent", "[", "list_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{"list", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Length", "@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", "s"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", "#", "]"}], ">", "0.0001"}], "&"}]}], "]"}]}], 
      "\[Equal]", 
      RowBox[{"Length", "[", "s", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5877260776937785`*^9, 3.5877260839744654`*^9}, {
  3.587726126189433*^9, 3.5877261308296423`*^9}, {3.587726225399293*^9, 
  3.5877263003613253`*^9}, {3.587728905498708*^9, 3.58772890698293*^9}, {
  3.5879116670440125`*^9, 3.5879116872129855`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SolveBaeEquations", "[", 
   RowBox[{"eqns_", ",", "S_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"us", "=", 
      RowBox[{"Quiet", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"u", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"#2", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", "#1"}], "&"}], 
        ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Union", "[", 
      RowBox[{"Sort", "/@", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"us", "/.", 
          RowBox[{"Solve", "[", 
           RowBox[{"eqns", ",", "us"}], "]"}]}], ",", "AllDifferent"}], 
        "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.605530067382595*^9, 3.605530147726263*^9}, {
  3.605530221351263*^9, 3.605530453507513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BaeRootsWithEnergy", "[", 
   RowBox[{"roots_", ",", "S_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"roots", ",", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "S"], 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"u", "[", "i", "]"}], "2"], "+", 
        RowBox[{"1", "/", "4"}]}]]}], "/.", "roots"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.605532215366888*^9, 3.605532281679388*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.587910549089818*^9, 3.587910549370728*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Bae", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "//", 
   RowBox[{
    RowBox[{"SolveBaeEquations", "[", 
     RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"BaeRootsWithEnergy", "[", 
    RowBox[{"#", ",", "2"}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.6055268915970535`*^9, 3.605526895799183*^9}, {
   3.6055280284814672`*^9, 3.6055280285908413`*^9}, {3.6055294579801035`*^9, 
   3.6055294646832285`*^9}, 3.605529510698658*^9, {3.605532174976263*^9, 
   3.605532180851263*^9}, 3.605532310241888*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "(", "1", ")"}], "\[Rule]", 
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["3"]}]]}]}], ",", 
        RowBox[{
         RowBox[{"u", "(", "2", ")"}], "\[Rule]", 
         FractionBox["1", 
          RowBox[{"2", " ", 
           SqrtBox["3"]}]]}]}], "}"}]},
     {"6"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.605526896689597*^9, 3.605528028887715*^9, {3.6055294602457285`*^9, 
   3.6055294649019785`*^9}, 3.60552951105803*^9, {3.605532178804388*^9, 
   3.605532181460638*^9}, 3.605532311163763*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", "x_", "]"}], "=", 
   RowBox[{"g", 
    RowBox[{"(", 
     RowBox[{"x", "+", 
      FractionBox["1", "x"]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.605610043756465*^9, 3.605610056990925*^9}, 
   3.6056100940849123`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "[", "u_", "]"}], "=", 
  RowBox[{"x", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "+", 
        FractionBox["1", "x"]}], "==", " ", 
       FractionBox["u", "g"]}], ",", "x"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6055288577769785`*^9, 3.6055290341676035`*^9}, {
  3.605530837945013*^9, 3.605530840710638*^9}}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["u", "2"], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["g", "2"]}]}]], "+", "u"}], 
   RowBox[{"2", " ", "g"}]], TraditionalForm]], "Output",
 CellChangeTimes->{3.6055290345582285`*^9, 3.605530841320013*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BaeFull", "[", 
   RowBox[{"J_", ",", "S_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        RowBox[{"x", "[", 
         RowBox[{
          RowBox[{"u", "[", "k", "]"}], "+", 
          RowBox[{"I", "/", "2"}]}], "]"}], 
        RowBox[{"x", "[", 
         RowBox[{
          RowBox[{"u", "[", "k", "]"}], "-", 
          RowBox[{"I", "/", "2"}]}], "]"}]], ")"}], "J"], "\[Equal]", 
     RowBox[{
      SubsuperscriptBox["\[Product]", 
       RowBox[{"j", "=", "1"}], "S"], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"j", "\[Equal]", "k"}], ",", "1", ",", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{
             RowBox[{"u", "[", "k", "]"}], "-", 
             RowBox[{"I", "/", "2"}]}], "]"}], "-", 
           RowBox[{"x", "[", 
            RowBox[{
             RowBox[{"u", "[", "j", "]"}], "+", 
             RowBox[{"I", "/", "2"}]}], "]"}]}], 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{
             RowBox[{"u", "[", "k", "]"}], "+", 
             RowBox[{"I", "/", "2"}]}], "]"}], "-", 
           RowBox[{"x", "[", 
            RowBox[{
             RowBox[{"u", "[", "j", "]"}], "-", 
             RowBox[{"I", "/", "2"}]}], "]"}]}]], 
         FractionBox[
          RowBox[{"1", "-", 
           FractionBox["1", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{"u", "[", "k", "]"}], "+", 
               RowBox[{"I", "/", "2"}]}], "]"}], 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{"u", "[", "j", "]"}], "-", 
               RowBox[{"I", "/", "2"}]}], "]"}]}]]}], 
          RowBox[{"1", "-", 
           FractionBox["1", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{"u", "[", "k", "]"}], "-", 
               RowBox[{"I", "/", "2"}]}], "]"}], 
             RowBox[{"x", "[", 
              RowBox[{
               RowBox[{"u", "[", "j", "]"}], "+", 
               RowBox[{"I", "/", "2"}]}], "]"}]}]]}]]}]}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "S"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6055286648394785`*^9, 3.6055288383394785`*^9}, {
  3.6055289696207285`*^9, 3.6055290015113535`*^9}, {3.6055290451988535`*^9, 
  3.6055292138238535`*^9}, {3.6055294790582285`*^9, 3.605529482870711*^9}, {
  3.6055295654639325`*^9, 3.6055295727451353`*^9}, {3.6055296691507688`*^9, 
  3.605529674885107*^9}, {3.605529934961568*^9, 3.605529980742524*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"BaeFull", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "//", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"g", ",", "0", ",", "0"}], "}"}]}], "]"}], "&"}]}], "//", 
     "PowerExpand"}], "//", "Simplify"}], "//", 
   RowBox[{
    RowBox[{"SolveBaeEquations", "[", 
     RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
  RowBox[{
   RowBox[{"BaeRootsWithEnergy", "[", 
    RowBox[{"#", ",", "2"}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.605532098163763*^9, 3.605532169491888*^9}, {
  3.605532286898138*^9, 3.605532290976263*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"u", "(", "1", ")"}], "\[Rule]", 
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            SqrtBox["3"]}]]}]}], ",", 
        RowBox[{
         RowBox[{"u", "(", "2", ")"}], "\[Rule]", 
         FractionBox["1", 
          RowBox[{"2", " ", 
           SqrtBox["3"]}]]}]}], "}"}]},
     {"6"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.605532121007513*^9, 3.605532170148138*^9}, 
   3.605532291741888*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.605530326898138*^9, 3.605530338695013*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.6055334332026167`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.605531499241888*^9, 3.605531499288763*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{"x", "[", 
           RowBox[{
            RowBox[{"u", "[", "xk", "]"}], "+", 
            RowBox[{"I", "/", "2"}]}], "]"}], 
          RowBox[{"x", "[", 
           RowBox[{
            RowBox[{"u", "[", "xk", "]"}], "-", 
            RowBox[{"I", "/", "2"}]}], "]"}]], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"g", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], "//", 
      "Simplify"}], "//", "Normal"}], "//", "Together"}], "//", 
   "PowerExpand"}]}]], "Input",
 CellChangeTimes->{{3.6055340096571317`*^9, 3.605534078298196*^9}, {
  3.605534271313987*^9, 3.605534279642112*^9}, {3.605535880063987*^9, 
  3.605535923142112*^9}, {3.605535994220237*^9, 3.605536009079612*^9}, {
  3.605536468313987*^9, 3.605536469204612*^9}, {3.6056106789480305`*^9, 
  3.6056107068700843`*^9}, {3.6056108549647818`*^9, 3.605610860574193*^9}, {
  3.6056118773424997`*^9, 3.6056119116862497`*^9}}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "xk"}], 
   RowBox[{"g", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["xk", "2"], "-", "1"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.605534023172843*^9, 3.6055340785325727`*^9}, 
   3.605534280438987*^9, {3.605535894907737*^9, 3.605535923610862*^9}, {
   3.605536002423362*^9, 3.605536009313987*^9}, 3.605536470532737*^9, {
   3.605610703198186*^9, 3.6056107072607117`*^9}, {3.6056108565585423`*^9, 
   3.605610860746069*^9}, 3.6056118799831247`*^9, 3.6056119122643747`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"Log", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "[", "xk", "]"}], "-", 
              RowBox[{"I", "/", "2"}]}], "]"}], "-", 
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "[", "xj", "]"}], "+", 
              RowBox[{"I", "/", "2"}]}], "]"}]}], 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "[", "xk", "]"}], "+", 
              RowBox[{"I", "/", "2"}]}], "]"}], "-", 
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"u", "[", "xj", "]"}], "-", 
              RowBox[{"I", "/", "2"}]}], "]"}]}]], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"g", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], "//", 
       "Normal"}], "//", "Together"}], "//", "PowerExpand"}], "//", 
    "FullSimplify"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.605536036595237*^9, 3.605536098470237*^9}, {
  3.605536136157737*^9, 3.605536147688987*^9}, {3.605536454110862*^9, 
  3.605536474360862*^9}, {3.605538566616622*^9, 3.605538607757247*^9}, {
  3.6056107458547087`*^9, 3.6056108261052227`*^9}, {3.605610864183591*^9, 
  3.605610882683709*^9}, {3.6056118818112497`*^9, 3.6056118828737497`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["xj", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["xk", "2"]}]}], ")"}]}], "+", 
       SuperscriptBox["xk", "2"]}], ")"}]}], 
    RowBox[{"g", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["xj", "2"], "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["xk", "2"], "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"xj", "-", "xk"}], ")"}]}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.605536089470237*^9, 3.605536099001487*^9}, {
   3.605536141610862*^9, 3.605536148282737*^9}, {3.605536454938987*^9, 
   3.605536475220237*^9}, {3.605538572632247*^9, 3.605538608179122*^9}, {
   3.6056107963081565`*^9, 3.6056108266364756`*^9}, {3.6056108656054754`*^9, 
   3.605610882996211*^9}, 3.6056118834206247`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term3", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{"u", "[", "xk", "]"}], "+", 
                RowBox[{"I", "/", "2"}]}], "]"}], 
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{"u", "[", "xj", "]"}], "-", 
                RowBox[{"I", "/", "2"}]}], "]"}]}], ")"}]}]}], 
          RowBox[{"1", "-", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{"u", "[", "xk", "]"}], "-", 
                RowBox[{"I", "/", "2"}]}], "]"}], 
              RowBox[{"x", "[", 
               RowBox[{
                RowBox[{"u", "[", "xj", "]"}], "+", 
                RowBox[{"I", "/", "2"}]}], "]"}]}], ")"}]}]}]], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"g", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], "//", 
      "Normal"}], "//", "Together"}], "//", "PowerExpand"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.605536232407737*^9, 3.605536263610862*^9}, {
  3.605536409642112*^9, 3.605536425173362*^9}, {3.605536476720237*^9, 
  3.605536478001487*^9}, {3.605610911902646*^9, 3.605610950777895*^9}, {
  3.6056118853893747`*^9, 3.6056118866706247`*^9}}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["xj", "2"], " ", "xk"}], "-", 
      RowBox[{"xj", " ", 
       SuperscriptBox["xk", "2"]}], "+", "xj", "-", "xk"}], ")"}]}], 
   RowBox[{"g", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["xj", "2"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["xk", "2"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"xj", " ", "xk"}], "-", "1"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.605536269204612*^9, 3.605536425907737*^9, 3.605536478673362*^9, {
   3.605610938059064*^9, 3.605610951074772*^9}, 3.6056118872018747`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term4", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u", "[", "xj", "]"}], "-", 
           RowBox[{"u", "[", "xk", "]"}]}], ")"}], 
         RowBox[{"Log", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{
                 RowBox[{"u", "[", "xj", "]"}], "-", 
                 RowBox[{"I", "/", "2"}]}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{
                 RowBox[{"u", "[", "xk", "]"}], "-", 
                 RowBox[{"I", "/", "2"}]}], "]"}]}], "-", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{
                 RowBox[{"u", "[", "xj", "]"}], "-", 
                 RowBox[{"I", "/", "2"}]}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{
                 RowBox[{"u", "[", "xk", "]"}], "+", 
                 RowBox[{"I", "/", "2"}]}], "]"}]}], "-", "1"}], ")"}]], 
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{
                 RowBox[{"u", "[", "xj", "]"}], "+", 
                 RowBox[{"I", "/", "2"}]}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{
                 RowBox[{"u", "[", "xk", "]"}], "+", 
                 RowBox[{"I", "/", "2"}]}], "]"}]}], "-", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{
                 RowBox[{"u", "[", "xj", "]"}], "+", 
                 RowBox[{"I", "/", "2"}]}], "]"}], 
               RowBox[{"x", "[", 
                RowBox[{
                 RowBox[{"u", "[", "xk", "]"}], "-", 
                 RowBox[{"I", "/", "2"}]}], "]"}]}], "-", "1"}], ")"}]]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"g", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], "//", 
      "Normal"}], "//", "Together"}], "//", "PowerExpand"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.605536336017112*^9, 3.605536400485862*^9}, 
   3.605536430907737*^9, {3.6056109596060767`*^9, 3.6056109870750027`*^9}, {
   3.605611173904323*^9, 3.6056111804824905`*^9}, {3.60561122031087*^9, 
   3.605611230092183*^9}, {3.6056118888737497`*^9, 3.6056118914206247`*^9}, {
   3.6056123475202017`*^9, 3.6056123691888866`*^9}}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"xj", " ", "xk", " ", 
    RowBox[{"(", 
     RowBox[{"xj", "-", "xk"}], ")"}]}], 
   RowBox[{"g", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["xj", "2"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["xk", "2"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"xj", " ", "xk"}], "-", "1"}], ")"}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.605536402110862*^9, 3.605536431798362*^9}, {
   3.6056111779824743`*^9, 3.60561123042031*^9}, 3.6056118919831247`*^9, 
   3.605612366017479*^9, 3.605612473439164*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{
   RowBox[{
    FractionBox["g", "I"], 
    FractionBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["xk", "2"], "-", "1"}], ")"}], 
     SuperscriptBox["xk", "2"]], "J", " ", "term1"}], "-", 
   RowBox[{"Apart", "@", 
    RowBox[{"Simplify", "@", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["g", "I"], 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["xk", "2"], "-", "1"}], ")"}], 
        SuperscriptBox["xk", "2"]], 
       RowBox[{"(", 
        RowBox[{"term2", "-", "term3", "+", 
         RowBox[{"2", "I", " ", "term4"}]}], ")"}]}], ")"}]}]}]}], 
  ")"}]], "Input",
 CellChangeTimes->{{3.6056118937487497`*^9, 3.6056119183268747`*^9}, {
  3.6056119597174997`*^9, 3.6056119955768747`*^9}, {3.6056122592174997`*^9, 
  3.6056122740768747`*^9}, {3.605612506028116*^9, 3.6056125268063073`*^9}, {
  3.6056125575205355`*^9, 3.6056126293742943`*^9}, {3.6056129532876253`*^9, 
  3.6056129538032503`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["J", "xk"], "+", 
   FractionBox["2", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"xj", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"xj", "+", "1"}], ")"}], " ", "xk"}]], "+", 
   FractionBox["2", 
    RowBox[{"xk", "-", "xj"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6056125785643125`*^9, 3.6056126299211445`*^9}, 
   3.605612706339596*^9, 3.6056129544907503`*^9}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.6056129708501253`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"I", " ", "2", "g", " ", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"x", "[", 
        RowBox[{
         RowBox[{"u", "[", "xk", "]"}], "+", 
         RowBox[{"I", "/", "2"}]}], "]"}]], "-", 
      FractionBox["1", 
       RowBox[{"x", "[", 
        RowBox[{
         RowBox[{"u", "[", "xk", "]"}], "-", 
         RowBox[{"I", "/", "2"}]}], "]"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"g", ",", "\[Infinity]", ",", "2"}], "}"}]}], "]"}]}], "//", 
  "PowerExpand"}]], "Input",
 CellChangeTimes->{{3.605536602954612*^9, 3.605536678063987*^9}, {
  3.605610136116431*^9, 3.6056101647259893`*^9}, {3.6056102118356657`*^9, 
  3.605610217335701*^9}, {3.6056130325688753`*^9, 3.6056130346782503`*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    FractionBox["2", 
     RowBox[{
      SuperscriptBox["xk", "2"], "-", "1"}]], "+", 
    InterpretationBox[
     RowBox[{"O", "(", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", "g"], ")"}], "2"], ")"}],
     SeriesData[$CellContext`g, 
      DirectedInfinity[1], {}, 0, 2, 1],
     Editable->False]}],
   SeriesData[$CellContext`g, 
    DirectedInfinity[1], {2/(-1 + $CellContext`xk^2)}, 0, 2, 1],
   Editable->False], TraditionalForm]], "Output",
 CellChangeTimes->{{3.605536622267112*^9, 3.605536678813987*^9}, {
   3.605610143225852*^9, 3.6056101650384912`*^9}, 3.6056102181794567`*^9, 
   3.6056130354907503`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.605536026798362*^9, 3.605536027657737*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "G", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6056166912563753`*^9, 3.6056166989282503`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"x_", ",", "S_"}], "]"}], "=", 
   RowBox[{
    SubsuperscriptBox["\[Sum]", 
     RowBox[{"j", "=", "1"}], "S"], 
    FractionBox["1", 
     RowBox[{"x", "-", 
      RowBox[{"xx", "[", "j", "]"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "[", "x_", "]"}], "=", 
   RowBox[{
    RowBox[{"G", "[", 
     RowBox[{"x", ",", "1"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"xx", "[", "1", "]"}], "\[Rule]", "xk"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.605530456632513*^9, 3.605530479804388*^9}, {
   3.605530543429388*^9, 3.605530545366888*^9}, {3.605531094695013*^9, 
   3.605531098070013*^9}, {3.605532856445013*^9, 3.605532887132513*^9}, {
   3.605532923663763*^9, 3.605532926710638*^9}, 3.6056130634595003`*^9, {
   3.6056161035688753`*^9, 3.6056161063345003`*^9}, {3.6056162544126253`*^9, 
   3.6056162545688753`*^9}, {3.6056167298657503`*^9, 3.6056167481782503`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "xk"], 
     FractionBox["1", 
      RowBox[{"x", "-", "xk"}]], 
     RowBox[{"(", 
      RowBox[{"J", "+", "\[Gamma]", "+", 
       FractionBox["2", 
        RowBox[{"1", "-", 
         SuperscriptBox["xk", "2"]}]]}], ")"}]}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"\[CapitalLambda]", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["xk", "2"], "-", "1"}], ")"}]}], 
      RowBox[{"2", 
       SuperscriptBox["xk", "2"]}]], 
     FractionBox["1", 
      RowBox[{"x", "-", "xk"}]]}]}], "//", "Together"}]}]], "Input",
 CellChangeTimes->{{3.6056147368032503`*^9, 3.6056148677876253`*^9}, {
  3.6056163065376253`*^9, 3.6056163078345003`*^9}}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", "J", " ", 
     SuperscriptBox["xk", "3"]}], "-", 
    RowBox[{"2", " ", "J", " ", "xk"}], "-", "\[CapitalLambda]", "-", 
    RowBox[{"\[CapitalLambda]", " ", 
     SuperscriptBox["xk", "4"]}], "+", 
    RowBox[{"2", " ", "\[Gamma]", " ", 
     SuperscriptBox["xk", "3"]}], "+", 
    RowBox[{"2", " ", "\[CapitalLambda]", " ", 
     SuperscriptBox["xk", "2"]}], "-", 
    RowBox[{"2", " ", "\[Gamma]", " ", "xk"}], "-", 
    RowBox[{"4", " ", "xk"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["xk", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["xk", "2"], "-", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"x", "-", "xk"}], ")"}]}]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6056147704751253`*^9, 3.6056148682876253`*^9}, 
   3.6056163080220003`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"J", "+", "\[Gamma]", "+", "2"}], "x"], "-", 
         FractionBox[
          RowBox[{"2", "x"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "-", "1"}]], "+", 
         RowBox[{
          FractionBox["\[CapitalLambda]", "2"], 
          FractionBox[
           RowBox[{"1", "-", 
            SuperscriptBox["x", "2"]}], 
           SuperscriptBox["x", "2"]]}]}], ")"}], 
       RowBox[{"G", "[", "x", "]"}]}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"J", "+", "\[Gamma]", "+", "2"}], ")"}], 
         FractionBox[
          RowBox[{"G", "[", "0", "]"}], "x"]}], "+", 
        RowBox[{
         FractionBox["\[CapitalLambda]", "2"], 
         FractionBox[
          RowBox[{
           RowBox[{"G", "[", "0", "]"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"G", "'"}], "[", "0", "]"}], "x"}]}], 
          SuperscriptBox["x", "2"]]}], "-", 
        FractionBox[
         RowBox[{"G", "[", "1", "]"}], 
         RowBox[{"x", "-", "1"}]], "-", 
        FractionBox[
         RowBox[{"G", "[", 
          RowBox[{"-", "1"}], "]"}], 
         RowBox[{"x", "+", "1"}]]}], ")"}]}], "/.", 
     RowBox[{
      RowBox[{"xx", "[", "1", "]"}], "\[Rule]", "xk"}]}], "//", "Simplify"}], 
   "//", "Expand"}], "//", "Together"}]], "Input",
 CellChangeTimes->{{3.6056161096626253`*^9, 3.6056163006313753`*^9}}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", "J", " ", 
     SuperscriptBox["xk", "3"]}], "-", 
    RowBox[{"2", " ", "J", " ", "xk"}], "-", "\[CapitalLambda]", "-", 
    RowBox[{"\[CapitalLambda]", " ", 
     SuperscriptBox["xk", "4"]}], "+", 
    RowBox[{"2", " ", "\[Gamma]", " ", 
     SuperscriptBox["xk", "3"]}], "+", 
    RowBox[{"2", " ", "\[CapitalLambda]", " ", 
     SuperscriptBox["xk", "2"]}], "-", 
    RowBox[{"2", " ", "\[Gamma]", " ", "xk"}], "-", 
    RowBox[{"4", " ", "xk"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"xk", "-", "1"}], ")"}], " ", 
    SuperscriptBox["xk", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"xk", "+", "1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"x", "-", "xk"}], ")"}]}]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6056162601626253`*^9, 3.6056163008813753`*^9}}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.6056163376938753`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"G", "[", 
    RowBox[{"x", ",", "5"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "\[Infinity]", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6056163705532503`*^9, 3.6056163972407503`*^9}, {
   3.6056164328032503`*^9, 3.6056164507720003`*^9}, 3.6056164958970003`*^9, {
   3.6056165488345003`*^9, 3.6056165617407503`*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    FractionBox["5", "x"], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"xx", "(", "1", ")"}], "+", 
      RowBox[{"xx", "(", "2", ")"}], "+", 
      RowBox[{"xx", "(", "3", ")"}], "+", 
      RowBox[{"xx", "(", "4", ")"}], "+", 
      RowBox[{"xx", "(", "5", ")"}]}], 
     SuperscriptBox["x", "2"]], "+", 
    InterpretationBox[
     RowBox[{"O", "(", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", "x"], ")"}], "3"], ")"}],
     SeriesData[$CellContext`x, 
      DirectedInfinity[1], {}, 1, 3, 1],
     Editable->False]}],
   SeriesData[$CellContext`x, 
    DirectedInfinity[1], {
    5, $CellContext`xx[1] + $CellContext`xx[2] + $CellContext`xx[
      3] + $CellContext`xx[4] + $CellContext`xx[5]}, 1, 3, 1],
   Editable->False], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6056163724438753`*^9, 3.6056163974595003`*^9}, {
   3.6056164336001253`*^9, 3.6056164514595003`*^9}, 3.6056164962563753`*^9, {
   3.6056165496001253`*^9, 3.6056165623345003`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"G", "[", 
      RowBox[{"x", ",", "5"}], "]"}], ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "\[Infinity]", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6056164638657503`*^9, 3.6056164914438753`*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox["5", 
      SuperscriptBox["x", "2"]]}], "+", 
    InterpretationBox[
     RowBox[{"O", "(", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", "x"], ")"}], "3"], ")"}],
     SeriesData[$CellContext`x, 
      DirectedInfinity[1], {}, 2, 3, 1],
     Editable->False]}],
   SeriesData[$CellContext`x, 
    DirectedInfinity[1], {-5}, 2, 3, 1],
   Editable->False], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6056164665063753`*^9, 3.6056164917563753`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6056167836938753`*^9, 3.6056167861157503`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "x_", "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"J", "+", "\[Gamma]", "+", "2"}], ")"}], 
      FractionBox[
       RowBox[{"G", "[", "0", "]"}], "x"]}], "+", 
     RowBox[{
      FractionBox["\[CapitalLambda]", "2"], 
      FractionBox[
       RowBox[{
        RowBox[{"G", "[", "0", "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"G", "'"}], "[", "0", "]"}], "x"}]}], 
       SuperscriptBox["x", "2"]]}], "-", 
     FractionBox[
      RowBox[{"G", "[", "1", "]"}], 
      RowBox[{"x", "-", "1"}]], "-", 
     FractionBox[
      RowBox[{"G", "[", 
       RowBox[{"-", "1"}], "]"}], 
      RowBox[{"x", "+", "1"}]]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6056176573188753`*^9, 3.6056176595532503`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FS", "[", "x_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"F", "[", "x", "]"}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"G", "'"}], "[", "0", "]"}], "\[Rule]", 
        RowBox[{
         FractionBox["1", "\[CapitalLambda]"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"G", "[", "1", "]"}]}], "+", 
           RowBox[{"2", 
            RowBox[{"G", "[", 
             RowBox[{"-", "1"}], "]"}]}], "-", 
           RowBox[{"2", 
            RowBox[{"G", "[", "0", "]"}], 
            RowBox[{"(", 
             RowBox[{"J", "+", "\[Gamma]", "+", "2"}], ")"}]}], "-", 
           RowBox[{"\[CapitalLambda]", " ", "S"}]}], ")"}]}]}]}], "//", 
      "Simplify"}], "//", "Apart"}], "//", 
    RowBox[{
     RowBox[{"Apart", "/@", "#"}], "&"}]}], "//", 
   RowBox[{
    RowBox[{"Apart", "/@", "#"}], "&"}]}]}]], "Input",
 CellChangeTimes->{{3.6056176323032503`*^9, 3.6056177105845003`*^9}, 
   3.6056177445063753`*^9, {3.6056178286938753`*^9, 3.6056178661782503`*^9}, {
   3.6056179268501253`*^9, 3.6056179640688753`*^9}, {3.6056185607876253`*^9, 
   3.6056185641626253`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"G", "(", "0", ")"}], " ", "\[CapitalLambda]"}], 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"]}]], "+", 
   FractionBox[
    RowBox[{"G", "(", 
     RowBox[{"-", "1"}], ")"}], 
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{"x", "+", "1"}], ")"}]}]], "-", 
   FractionBox[
    RowBox[{"G", "(", "1", ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "1"}], ")"}], " ", "x"}]], "-", 
   FractionBox[
    RowBox[{"\[CapitalLambda]", " ", "S"}], 
    RowBox[{"2", " ", "x"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6056176876782503`*^9, 3.6056177112563753`*^9}, 
   3.6056177451782503`*^9, {3.6056178507095003`*^9, 3.6056178665220003`*^9}, {
   3.6056179272563753`*^9, 3.6056179644282503`*^9}, 3.6056185653188753`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DSolve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G", "'"}], "[", "x", "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"J", "+", "2"}], ")"}], "x"], "-", 
        FractionBox[
         RowBox[{"2", "x"}], 
         RowBox[{
          SuperscriptBox["x", "2"], "-", "1"}]], "+", 
        RowBox[{
         FractionBox["\[CapitalLambda]", "2"], 
         FractionBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}], 
          SuperscriptBox["x", "2"]]}]}], ")"}], 
      RowBox[{"G", "[", "x", "]"}]}]}], "\[Equal]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FS", "[", "x", "]"}], "/.", 
      RowBox[{
       RowBox[{"G", "[", "a_", "]"}], "\[Rule]", 
       RowBox[{"GG", "[", "a", "]"}]}]}], ")"}]}], ",", 
   RowBox[{"G", "[", "x", "]"}], ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.6056185677251253`*^9, 3.6056186365532503`*^9}}],

Cell[BoxData[
 FormBox["$Aborted", TraditionalForm]], "Output",
 CellChangeTimes->{3.6056186166626253`*^9, 3.6056187722563753`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "[", "x_", "]"}], "=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"J", "+", "2"}], ")"}], "x"], "-", 
        FractionBox[
         RowBox[{"2", "x"}], 
         RowBox[{
          SuperscriptBox["x", "2"], "-", "1"}]], "+", 
        RowBox[{
         FractionBox["\[CapitalLambda]", "2"], 
         FractionBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"]}], 
          SuperscriptBox["x", "2"]]}]}], ")"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6056189437563753`*^9, 3.6056189615532503`*^9}, {
  3.6056190424126253`*^9, 3.6056190452720003`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["x", 
     RowBox[{"J", "+", "2"}]], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[CapitalLambda]", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", "1"}], ")"}]}], 
       RowBox[{"2", " ", "x"}]]}]]}], 
   RowBox[{
    SuperscriptBox["x", "2"], "-", "1"}]]}]], "Output",
 CellChangeTimes->{{3.6056189543188753`*^9, 3.6056189619438753`*^9}, 
   3.6056190460688753`*^9, 3.605619812352375*^9, {3.605620564493*^9, 
   3.6056205730555*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Residue", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FS", "[", "x", "]"}], 
      RowBox[{"M", "[", "x", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], "\[Equal]", "0"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6056194418501253`*^9, 3.605619523007181*^9}, 
   3.605619949852375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], "J"], " ", 
   SuperscriptBox["\[ExponentialE]", "\[CapitalLambda]"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"G", "[", 
       RowBox[{"-", "1"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "J"}], "+", "1"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"G", "[", "0", "]"}], " ", "\[CapitalLambda]"}], "-", 
     RowBox[{"G", "[", "1", "]"}], "+", 
     RowBox[{"\[CapitalLambda]", " ", "S"}]}], ")"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.6056194504282503`*^9, 3.6056195234446898`*^9}, {
  3.605619937571125*^9, 3.605619952743*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FSS", "[", "x_", "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"FS", "[", "x", "]"}], "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"G", "[", "1", "]"}], " ", "J"}], "-", 
               RowBox[{
                RowBox[{"G", "[", "0", "]"}], " ", "\[CapitalLambda]"}], "-", 
               RowBox[{"G", "[", 
                RowBox[{"-", "1"}], "]"}], "+", 
               RowBox[{"G", "[", "1", "]"}], "+", 
               RowBox[{"\[CapitalLambda]", " ", "S"}]}], "\[Equal]", "0"}], 
             ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"G", "[", 
                 RowBox[{"-", "1"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "J"}], "+", "1"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"G", "[", "0", "]"}], " ", "\[CapitalLambda]"}], "-", 
               RowBox[{"G", "[", "1", "]"}], "+", 
               RowBox[{"\[CapitalLambda]", " ", "S"}]}], "\[Equal]", "0"}], 
             ",", 
             RowBox[{"\[Gamma]", "\[Equal]", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"G", "[", "1", "]"}]}], "+", 
               RowBox[{"G", "[", 
                RowBox[{"-", "1"}], "]"}]}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"G", "[", 
              RowBox[{"-", "1"}], "]"}], ",", 
             RowBox[{"G", "[", "1", "]"}], ",", 
             RowBox[{"G", "[", "0", "]"}]}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}], "//", 
      "Apart"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{"#", ",", "J", ",", "Simplify"}], "]"}], "&"}], "/@", "#"}], 
      "&"}]}], "//", "Simplify"}], "//", "Apart"}]}]], "Input",
 CellChangeTimes->{{3.605619943914875*^9, 3.605620060102375*^9}, {
  3.605620676633625*^9, 3.60562067902425*^9}, {3.605624121571125*^9, 
  3.605624178946125*^9}, {3.605624243227375*^9, 3.605624247289875*^9}, {
  3.605624397039875*^9, 3.605624427508625*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[CapitalLambda]", " ", "S", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"J", " ", 
         SuperscriptBox["x", "2"]}], "-", "J", "-", "2"}], ")"}]}], 
     RowBox[{"2", " ", "J", " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "-", "1"}], ")"}]}]]}], "-", 
   FractionBox[
    RowBox[{"\[Gamma]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", " ", 
        SuperscriptBox["x", "2"]}], "-", "J", "-", 
       SuperscriptBox["x", "2"], "-", "1"}], ")"}]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "-", "1"}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.60561996508675*^9, 3.605620061008625*^9}, 
   3.605620679993*^9, {3.605624135602375*^9, 3.605624179743*^9}, {
   3.60562424452425*^9, 3.605624247539875*^9}, {3.6056244018055*^9, 
   3.605624427696125*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FSS", "[", "x", "]"}], 
  RowBox[{"M", "[", "x", "]"}]}]], "Input",
 CellChangeTimes->{{3.605620680914875*^9, 3.605620758914875*^9}, 
   3.60562418683675*^9, {3.6056242906805*^9, 3.605624303571125*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["x", 
      RowBox[{"J", "+", "2"}]], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[CapitalLambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", "1"}], ")"}]}], 
        RowBox[{"2", " ", "x"}]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[CapitalLambda]", " ", "S", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"J", " ", 
             SuperscriptBox["x", "2"]}], "-", "J", "-", "2"}], ")"}]}], 
         RowBox[{"2", " ", "J", " ", "x", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "-", "1"}], ")"}]}]]}], "-", 
       FractionBox[
        RowBox[{"\[Gamma]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"J", " ", 
            SuperscriptBox["x", "2"]}], "-", "J", "-", 
           SuperscriptBox["x", "2"], "-", "1"}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["x", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "-", "1"}], ")"}]}]]}], ")"}]}], 
    RowBox[{
     SuperscriptBox["x", "2"], "-", "1"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.605620683133625*^9, 3.605620759352375*^9}, 
   3.60562413983675*^9, 3.60562418714925*^9, {3.6056242864305*^9, 
   3.6056243039305*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.605624371821125*^9, 3.6056243843055*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{712, 973},
WindowMargins->{{0, Automatic}, {0, Automatic}},
ShowSelection->True,
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 224, 7, 101, "Title"],
Cell[806, 31, 101, 1, 56, "Subtitle"],
Cell[910, 34, 126, 3, 30, "Text"],
Cell[1039, 39, 2886, 79, 194, "Input"],
Cell[3928, 120, 105, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[4058, 128, 638, 10, 31, "Input"],
Cell[4699, 140, 1955, 51, 87, "Output"]
}, Open  ]],
Cell[6669, 194, 101, 4, 49, "Text"],
Cell[6773, 200, 789, 23, 92, "Input"],
Cell[CellGroupData[{
Cell[7587, 227, 558, 9, 31, "Input"],
Cell[8148, 238, 833, 17, 30, "Output"]
}, Open  ]],
Cell[8996, 258, 109, 4, 49, "Text"],
Cell[9108, 264, 848, 23, 52, "Input"],
Cell[CellGroupData[{
Cell[9981, 291, 1740, 26, 31, "Input"],
Cell[11724, 319, 2102, 44, 63, "Output"]
}, Open  ]],
Cell[13841, 366, 105, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[13971, 374, 1951, 49, 205, "Input"],
Cell[15925, 425, 770, 17, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16732, 447, 1176, 32, 92, "Input"],
Cell[17911, 481, 1460, 42, 63, "Output"]
}, Open  ]],
Cell[19386, 526, 96, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[19507, 531, 128, 2, 56, "Subtitle"],
Cell[19638, 535, 1103, 31, 49, "Input"],
Cell[20744, 568, 1175, 31, 92, "Input"],
Cell[21922, 601, 1154, 34, 92, "Input"],
Cell[23079, 637, 509, 15, 49, "Input"],
Cell[23591, 654, 92, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[23708, 659, 580, 14, 31, "Input"],
Cell[24291, 675, 1141, 33, 62, "Output"]
}, Open  ]],
Cell[25447, 711, 286, 9, 46, "Input"],
Cell[CellGroupData[{
Cell[25758, 724, 449, 13, 48, "Input"],
Cell[26210, 739, 315, 10, 61, "Output"]
}, Open  ]],
Cell[26540, 752, 2672, 73, 162, "Input"],
Cell[CellGroupData[{
Cell[29237, 829, 696, 21, 52, "Input"],
Cell[29936, 852, 1019, 31, 62, "Output"]
}, Open  ]],
Cell[30970, 886, 92, 1, 31, "Input"],
Cell[31065, 889, 89, 1, 52, "Input"],
Cell[31157, 892, 92, 1, 31, InheritFromParent],
Cell[CellGroupData[{
Cell[31274, 897, 1098, 27, 70, "Input"],
Cell[32375, 926, 585, 13, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32997, 944, 1468, 37, 90, "Input"],
Cell[34468, 983, 1007, 27, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35512, 1015, 1540, 41, 90, "Input"],
Cell[37055, 1058, 752, 23, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37844, 1086, 2649, 70, 156, "Input"],
Cell[40496, 1158, 642, 19, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41175, 1182, 1002, 28, 57, "Input"],
Cell[42180, 1212, 447, 13, 51, "Output"]
}, Open  ]],
Cell[42642, 1228, 89, 1, 52, "Input"],
Cell[CellGroupData[{
Cell[42756, 1233, 783, 21, 48, "Input"],
Cell[43542, 1256, 700, 20, 53, "Output"]
}, Open  ]],
Cell[44257, 1279, 92, 1, 31, "Input"],
Cell[44352, 1282, 149, 3, 31, "Input"],
Cell[44504, 1287, 978, 24, 70, "Input"],
Cell[CellGroupData[{
Cell[45507, 1315, 763, 24, 52, "Input"],
Cell[46273, 1341, 861, 23, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47171, 1369, 1563, 48, 109, "Input"],
Cell[48737, 1419, 867, 23, 56, "Output"]
}, Open  ]],
Cell[49619, 1445, 89, 1, 52, "Input"],
Cell[CellGroupData[{
Cell[49733, 1450, 407, 9, 31, "Input"],
Cell[50143, 1461, 1049, 28, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51229, 1494, 333, 9, 31, "Input"],
Cell[51565, 1505, 570, 18, 49, "Output"]
}, Open  ]],
Cell[52150, 1526, 96, 1, 31, "Input"],
Cell[52249, 1529, 838, 27, 47, "Input"],
Cell[CellGroupData[{
Cell[53112, 1560, 1217, 34, 88, "Input"],
Cell[54332, 1596, 838, 24, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55207, 1625, 997, 31, 79, "Input"],
Cell[56207, 1658, 131, 2, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56375, 1665, 813, 25, 50, "Input"],
Cell[57191, 1692, 605, 18, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57833, 1715, 406, 13, 31, "Input"],
Cell[58242, 1730, 713, 21, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58992, 1756, 2373, 62, 112, "Input"],
Cell[61368, 1820, 1017, 30, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62422, 1855, 237, 5, 31, "Input"],
Cell[62662, 1862, 1503, 44, 79, "Output"]
}, Open  ]],
Cell[64180, 1909, 90, 1, 31, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
